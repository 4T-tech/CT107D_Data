C51 COMPILER V9.56.0.0   MAIN                                                              01/24/2025 11:23:46 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver) DEBUG OBJECTEXTEND PRI
                    -NT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          // 使用程序前，将J13调整为IO模式（2-3脚短接）
   2          #include "tim.h"
   3          #include "seg.h"
   4          #include <stdio.h>
   5          
   6          unsigned int  uiTms;                  // 毫秒值
   7          unsigned int  uiSec;                  // 秒值
   8          
   9          void Led_Proc(void);
  10          void Seg_Proc(void);
  11          // 主函数
  12          void main(void)
  13          {
  14   1        Close_Peripheral();
  15   1        T1_Init();
  16   1        
  17   1        while (1)
  18   1        {
  19   2          T1_Proc();
  20   2          Seg_Proc();
  21   2          Led_Proc();
  22   2        }
  23   1      }
  24          
  25          unsigned char pucSeg_Char[12];        // 显示字符
  26          unsigned char pucSeg_Code[8];         // 显示代码
  27          unsigned char ucSeg_Pos;              // 显示位置
  28          unsigned int  uiSeg_Dly;              // 显示刷新延时
  29          unsigned char ucSeg_Dly;              // 显示移位延时
  30          // 注意：sprintf()会在字符串后面添加”\0”，所以pucSeg_Buf[]的长度至少应为9。
  31          // 如果字符串中包含小数点，pucSeg_Buf[]的长度至少应为10。
  32          void Seg_Proc(void)
  33          {
  34   1        if (uiSeg_Dly > 300)                // 300ms刷新1次
  35   1        {
  36   2          uiSeg_Dly = 0;
  37   2      
  38   2          sprintf(pucSeg_Char, "1.   %04u", uiSec);
  39   2          Seg_Tran(pucSeg_Char, pucSeg_Code);
  40   2        }
  41   1        if (ucSeg_Dly >= 2)                 // 2ms移位1次
  42   1        {
  43   2          ucSeg_Dly = 0;
  44   2      
  45   2          Seg_Disp(pucSeg_Code[ucSeg_Pos], ucSeg_Pos);
  46   2          ucSeg_Pos = ++ucSeg_Pos & 7;      // 数码管循环显示
  47   2        }
  48   1      }
  49          
  50          void Led_Proc(void)
  51          {
  52   1        Led_Disp(uiSec);
  53   1       }

C51 COMPILER V9.56.0.0   MAIN                                                              01/24/2025 11:23:46 PAGE 2   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    110    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     28    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
